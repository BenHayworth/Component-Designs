<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Inexpensive Treadmill Visual stimulus demo</title>
		<style>
			body { margin: 0; }
		</style>
	</head>
	<body>
        <script type="module">
            import * as THREE from 'https://unpkg.com/three@0.127.0/build/three.module.js';
            import { DeviceOrientationControls } from 'https://unpkg.com/three@0.127.0/examples/jsm/controls/DeviceOrientationControls.js';;
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera( 120, window.innerWidth / window.innerHeight, 0.01, 2 );
            const controls = new DeviceOrientationControls( camera );
            const renderer = new THREE.WebGLRenderer();
            renderer.setSize( window.innerWidth, window.innerHeight );
            document.body.appendChild( renderer.domElement );

            const bangle = (10/180)*Math.PI;
            const geometry = new THREE.CylinderBufferGeometry(0.1525, 0.1525, 0.6, 12, 1, true, 0, bangle);
            const material = new THREE.MeshBasicMaterial( { color: 0x00ff00, side:THREE.DoubleSide } );
            const panels = new THREE.Group();
            for (let a = 0; a < 2*Math.PI; a+= bangle*2){
                const bar = new THREE.Mesh(geometry, material);
                bar.rotation.y = a;
                panels.add(bar);
            }

            let counter = 0;
            scene.add( panels );
            let direction = 1;
            const animate = function () {
                counter +=1;
                if( (counter % 500 - 250) > 0){ direction = 1; } else { direction = -1;}
                requestAnimationFrame( animate );
                controls.update();
                panels.rotation.y += 0.01 * direction;
                renderer.render( scene, camera );
            };

            animate();
          </script>
    </body>
</html>